"use strict";(self.webpackChunkng_app=self.webpackChunkng_app||[]).push([[129],{99129:(je,E,a)=>{a.r(E),a.d(E,{MvuModule:()=>Qe});var h=a(4857),Q=a(68359),C=a(63660),w=a(55297),b=a(73201),F=a(39230),G=a(68665),z=a(67914),j=a(82701),K=a(26186),q=a(29419),H=a(93849),c=a(44982),f=a(79210),V=a(75888),p=a(46570);var D=a(81226),v=a(4322);const U=(0,c.hE)(f.Xn.vehiclesTagCurrentStep,v.GC.Root),W=[{name:p.G.Mvu,abstract:!0,settings:{},resolve:[(0,c.IM)(f.IT.active),(0,c.oF)(f.s.Account),(0,c.QK)("cmsMvuFrame",{ItemId:"E6689601-07E1-4C8B-916D-964AA71E1155"}),(0,c.SZ)("stateList"),(0,c.pe)("countryList")]},{name:p.G.MvuUpload,url:D.Z.MvuUpload,settings:{},resolve:[(0,c.IM)(f.IT.active),(0,c.oF)(f.s.Account),(0,c.QK)("pageCms",{ItemId:"37F193AC-85E5-4220-9F9D-8B6B18E3CC34"}),(0,c.QK)("downInstructCms",{ItemId:"1EAE67A9-1427-445D-9786-7997A3A92A28"}),(0,c.QK)("downTemplCms",{ItemId:"6105C2A0-AD84-4491-BAE7-5C598A7B2889"}),(0,c.QK)("uploadVehicleCsvFileCms",{ItemId:"C2DD5DBB-7575-4295-9736-985D6B5E12F6"})],wizard:{nextState:p.G.MvuDeliveryMethod,cancelState:v.GC.Root}},{name:p.G.MvuDeliveryMethod,url:D.Z.MvuDeliveryMethod,settings:{},resolve:[(0,c.IM)(f.IT.active),(0,c.oF)(f.s.Account),U({explicitlyForbidden:[p.G.MvuReceipt]}),(0,c.QK)("cmsMvuDeliveryMethod",{ItemId:"3FA85E8A-BFF3-49BE-8F88-5772FF6B2220"}),(0,c.QK)("cancellationModal",{ItemId:"70803808-5433-4A41-B099-3F4379151F98"})],wizard:{nextState:p.G.MvuReviewOrder,prevState:p.G.MvuUpload,cancelState:v.GC.Root}},{name:p.G.MvuReviewOrder,url:D.Z.MvuReviewOrder,settings:{},resolve:[(0,c.IM)(f.IT.active),(0,c.oF)(f.s.Account),U({explicitlyForbidden:[p.G.MvuReceipt]}),(0,c.QK)("pageCms",{ItemId:"AA988F8A-9726-45D7-A88A-E794744E35CB"}),(0,c.QK)("replenishmentAmtModalCms",{ItemId:"7FD13832-3572-4EBA-BB89-48454CB6FF82"}),(0,c.QK)("tagInfoModalCms",{ItemId:"781C071D-31FB-4ABA-A73C-31CB8B722FC0"}),(0,c.QK)("cancellationModal",{ItemId:"70803808-5433-4A41-B099-3F4379151F98"}),(0,c.SZ)("stateList")],wizard:{nextState:p.G.MvuReceipt,prevState:p.G.MvuDeliveryMethod,cancelState:v.GC.Root}},{name:p.G.MvuReceipt,url:D.Z.MvuReceipt,settings:{},resolve:[(0,c.IM)(f.IT.active),(0,c.QK)("pageCms",{mergeParams:!0,ItemId:"1B3B1C91-FF7A-4FFC-AFFD-EF22A75F6F01"}),(0,c.oF)(f.s.Account),U({allowed:[p.G.MvuReviewOrder],explicitlyForbidden:[V.Dn.Frame,v.GC.Root]})],wizard:{nextState:v.GC.Root,isEndState:!0}}];var $=a(486),u=a(60195),k=a(61264),A=a(6304),e=a(13847),X=a(63457),ee=a(59008);function te(i,l){if(1&i&&e._UZ(0,"stepper",2),2&i){const t=e.oxw();e.Q6J("steps",t.steps)("stepMap",t.stepMap)}}let S=(()=>{class i{constructor(t,n){this.vehiclesManagerService=t,this.windowRef=n,this.steps=[],this.stepMap={},this.showStepper=!0}ngOnInit(){var t=this;return(0,u.Z)(function*(){t.vehiclesManagerService.clearData(),t.steps=[{name:t.cmsMvuFrame.step1,background:"secondary"},{name:t.cmsMvuFrame.step2,background:"secondary"},{name:t.cmsMvuFrame.step3,background:"secondary"},{name:t.cmsMvuFrame.step4,background:"secondary"}],t.stepMap={[p.G.MvuUpload]:1,[p.G.MvuDeliveryMethod]:2,[p.G.MvuReviewOrder]:3,[p.G.MvuReceipt]:4}})()}scrollToTop(){var t=this;return(0,u.Z)(function*(){t.isHidden=!0,yield(0,A.Dc)(20),t.windowRef.scrollTo(0,0),t.isHidden=!1})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(v.Tg),e.Y36(k.X9))},i.\u0275cmp=e.Xpm({type:i,selectors:[["vehicles-mvu-frame"]],inputs:{cmsMvuFrame:"cmsMvuFrame",stateList:"stateList",countryList:"countryList"},decls:3,vars:1,consts:[[1,"refresh-2020","u-spacing--widthFill"],[3,"steps","stepMap",4,"ngIf"],[3,"steps","stepMap"]],template:function(t,n){1&t&&(e.TgZ(0,"main",0),e.YNc(1,te,1,2,"stepper",1),e._UZ(2,"ui-view"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.showStepper))},directives:[h.O5,X.v,ee.UIView],styles:[""]}),i})();var N=a(81644),B=a(41034),ne=a(71390),ie=a(43036),oe=a(93309),ae=a(71696),se=a(63887),Y=a(37661),le=a(6737),M=a(96165),Z=a(83434),I=a(68043),J=a(39453),_=a(25023),T=a(45184),ce=a(14550),P=a(32993),L=a(27358);function de(i,l){if(1&i&&(e.TgZ(0,"span",40),e._uU(1),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.hij("",t.fileUploadProgress,"% ")}}const pe=function(i){return{width:i}};function ue(i,l){if(1&i){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",34)(2,"div",35)(3,"button",22),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return s.saveInformation(s.isFileValid)}),e._uU(4,"UPLOAD"),e.qZA()(),e.TgZ(5,"div",36)(6,"div",37)(7,"div",38),e.YNc(8,de,2,1,"span",39),e.qZA()()()(),e.BQk()}if(2&i){const t=e.oxw();e.xp6(7),e.Q6J("ngStyle",e.VKq(2,pe,t.fileUploadProgress+"%")),e.xp6(1),e.Q6J("ngIf",t.fileUploadProgress>0)}}const ve=function(){return{standalone:!0}};let ge=(()=>{class i{constructor(t,n,s,r,o,d,m,x){this.cmsUtilService=t,this.uploadService=n,this.toasterService=s,this.responseErrorService=r,this.stateService=o,this.vehicleService=d,this.serverConstants=m,this.uiRouterGlobals=x,this.uploadSuccess=!1}ngOnInit(){this.mvuInstructions=this.cmsUtilService.generateFileSrc('mediaid="{F6E5148C-C550-4D91-9B33-B17166E77D8E}"'),this.mvuTemplate=this.cmsUtilService.generateFileSrc('mediaid="{A46C6509-C479-4F12-8215-98AC861641A1}"')}onFileSelected(t){var n=this;return(0,u.Z)(function*(){n.file=t.target.files.length>0?t.target.files[0]:null,yield n.checkFileValid(n.file)})()}readFile(t){return new Promise((n,s)=>{const r=new FileReader;r.onerror=o=>{s(o.target.error)},r.onloadend=o=>{n(o.target.result)},r.readAsText(t)})}checkFileValid(t){var n=this;return(0,u.Z)(function*(){if((0,A.o8)(t)||null===t)n.setFileValidityModel(!1);else if("text/csv"===t.type||"application/vnd.ms-excel"===t.type){n.fileName=n.file.name;try{65533===(yield n.readFile(t.slice(0,1))).charCodeAt(0)?n.setFileValidityModel(!1,"Selected file must be formatted or Saved As a .CSV"):n.setFileValidityModel(!0)}catch{n.setFileValidityModel(!1)}}else n.setFileValidityModel(!1,"Selected file must be a .CSV")})()}setFileValidityModel(t,n){this.isFileValid=t,this.fileInvalidMessage=null!=n?n:""}saveInformation(t){var n=this;return(0,u.Z)(function*(){n.isFileValid&&t&&(yield n.uploadFile(n.file))})()}uploadFile(t){var n=this;return(0,u.Z)(function*(){if(!(0,A.o8)(t)&&null!==t){const s=n.uploadService.upload("/api/sessions/MultiVehicleUpload/UploadCSVFile",t).pipe((0,ne.U)(o=>{switch(o.type){case N.dt.UploadProgress:n.fileUploadProgress=Math.round(100*o.loaded/o.total);break;case N.dt.Response:return o}}),(0,ie.K)(o=>(n.fileUploadProgress=0,n.uploadSuccess=!1,(0,oe.x)([{body:o.error}],ae.z)))),r=yield function re(i,l){const t="object"==typeof l;return new Promise((n,s)=>{let o,r=!1;i.subscribe({next:d=>{o=d,r=!0},error:s,complete:()=>{r?n(o):t?n(l.defaultValue):s(new se.K)}})})}(s);if((0,A.Kn)(r)&&(0,A.Kn)(r.body)){const o=r.body;o.errors instanceof Array&&0===o.errors.length?(0,A.Kn)(o)&&o.alerts instanceof Array&&o.alerts.length>0&&(o.alerts.sort((y,R)=>y.importance-R.importance).map(y=>y.alertMsg).forEach(y=>n.toasterService.show("Success",y)),n.vehicleService.setMvuDetails(o),n.uploadSuccess=!0):(n.responseErrorService.handleMaintenanceErrors(o),"string"==typeof o.fileName&&""!==o.fileName&&n.toasterService.show("Error",`${o.hardErrorCount} errors. Click <a target="_blank" href="/api/sessions/Pdf/GetMvuErrorPdfReport/?reportId=${o.fileName}&angularState=${n.uiRouterGlobals.current.name}&clientVersion=${n.serverConstants.currentlyDownloadedWebUiVersion}">here</a> to download the errors in PDF`),n.responseErrorService.displayErrorsFromResponse(o))}}})()}nextStep(t){var n=this;return(0,u.Z)(function*(){n.isFileValid&&n.uploadSuccess&&(yield n.stateService.go(t))})()}cancel(t){var n=this;return(0,u.Z)(function*(){n.uploadSuccess&&n.vehicleService.destroyMvuDetails(),yield n.stateService.go(t)})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(Y.pA),e.Y36(le.C),e.Y36(M.MJ),e.Y36(M.Sr),e.Y36(Z.StateService),e.Y36(M.fi),e.Y36(B.vb),e.Y36(Z.UIRouterGlobals))},i.\u0275cmp=e.Xpm({type:i,selectors:[["vehicles-mvu-upload"]],inputs:{pageCms:"pageCms",downInstructCms:"downInstructCms",downTemplCms:"downTemplCms",uploadVehicleCsvFileCms:"uploadVehicleCsvFileCms"},decls:59,vars:18,consts:[[1,"refresh-2020"],["validation-focus","","novalidate","",1,"form-inline"],["uploadForm","ngForm"],[1,"u-spacing__fieldToSection--marginTop"],[1,"u-spacing__divider--marginTopBottom"],["fxLayout","row wrap"],["fxFlex","grow","fxLayout","row"],["aria-label","PDF Download Instructions","fxFlex","grow","target","_blank",3,"href"],["src","/Content/icons/pdf.gif","alt","Download multiple vehicle upload instructions pdf icon",1,"document-pdf-icon"],["fxFlex","grow","fxLayout","row",2,"padding-left","1.3rem"],["target","_blank","href","https://get.adobe.com/reader/"],["fxLayout","row wrap",1,"u-spacing__sectionToSection--marginTop"],["fxFlex","grow"],["aria-label","Template Download Instructions","target","_blank",3,"href"],["src","/Content/icons/excel.gif","alt","Download multiple vehicle upload template excel icon",1,"document-pdf-icon"],[1,"r-brackets"],[1,"note-text",2,"padding-left","1.3em","font-size","14px"],[1,"u-spacing__headerToSection--marginTop"],["fxFlex","grow","fxLayout","row",1,"u-spacing__sectionToSection--marginBottom"],[1,"note-text",2,"padding-top","0.5rem","font-size","14px"],["fxLayout","row"],["fxFlex.gt-sm","25","fxFlex.lt-md","50",2,"padding","0px"],[1,"btn","btn-file","upload-btn",3,"click"],["type","file","accept",".csv","required","",2,"display","none",3,"change"],["fileUpload",""],["fxFlex.gt-sm","75","fxFlex.lt-md","50",2,"padding","0px"],["type","text","placeholder","No file selected","readonly","",1,"form-control","upload-element",3,"ngModel","ngModelOptions"],[2,"color","red"],[4,"ngIf"],[1,"u-spacing__buttonToField--marginTop"],[3,"disabled","next","cancel"],["Wizard",""],["wizard-next",""],["wizard-cancel",""],["fxLayout","row",1,"u-spacing__fieldToSection--marginTop"],["fxFlex.gt-sm","25","fxFlex.lt-md","33",2,"padding","0px"],["fxFlex.gt-sm","83","fxFlex.lt-md","67",2,"height","48px","padding","0px"],[1,"progress","progress-bar-custom-corners","upload-element"],["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-success",3,"ngStyle"],["class","progress-text",4,"ngIf"],[1,"progress-text"]],template:function(t,n){if(1&t){const s=e.EpF();e.TgZ(0,"page-centered-container",0)(1,"form",1,2)(3,"div",3)(4,"card-container")(5,"header")(6,"h2"),e._uU(7),e.qZA(),e._UZ(8,"mat-divider",4),e.qZA(),e.TgZ(9,"section",5)(10,"div",6)(11,"a",7),e._UZ(12,"img",8),e._uU(13),e.qZA()(),e.TgZ(14,"div",9),e._uU(15),e.TgZ(16,"a",10),e._uU(17),e.qZA()()(),e.TgZ(18,"section",11)(19,"div",6)(20,"div",12)(21,"a",13),e._UZ(22,"img",14),e._uU(23),e.qZA(),e.TgZ(24,"span",15),e._uU(25),e.qZA()()(),e.TgZ(26,"div",6)(27,"div",16),e._uU(28),e.qZA()()(),e.TgZ(29,"header",17)(30,"h2"),e._uU(31),e.qZA(),e._UZ(32,"mat-divider",4),e.qZA(),e.TgZ(33,"section",5)(34,"div",6),e._uU(35),e.qZA(),e.TgZ(36,"div",18)(37,"div",19),e._uU(38),e.qZA()()(),e.TgZ(39,"mat-label"),e._uU(40,"SELECT A FILE TO UPLOAD"),e.qZA(),e.TgZ(41,"div",20)(42,"div",21)(43,"button",22),e.NdJ("click",function(){return e.CHM(s),e.MAs(46).click()}),e._uU(44,"SELECT FILE"),e.qZA(),e.TgZ(45,"input",23,24),e.NdJ("change",function(o){return n.onFileSelected(o)}),e.qZA()(),e.TgZ(47,"div",25),e._UZ(48,"input",26),e.qZA()(),e.TgZ(49,"div",27),e._uU(50),e.qZA(),e.YNc(51,ue,9,4,"ng-container",28),e.qZA(),e.TgZ(52,"section",29)(53,"wizard-ui",30,31),e.NdJ("next",function(o){return n.nextStep(o)})("cancel",function(o){return n.cancel(o)}),e.TgZ(55,"span",32),e._uU(56,"Next"),e.qZA(),e.TgZ(57,"span",33),e._uU(58,"Cancel"),e.qZA()()()()()()}if(2&t){const s=e.MAs(2);e.xp6(7),e.Oqu(n.pageCms.Title),e.xp6(4),e.Q6J("href",n.mvuInstructions,e.LSH),e.xp6(2),e.hij(" ",n.downInstructCms.LongDescription," "),e.xp6(2),e.hij(" ",n.downInstructCms.SearchTitle," "),e.xp6(2),e.hij(" \xa0",n.downInstructCms.SearchDescription," "),e.xp6(4),e.Q6J("href",n.mvuTemplate,e.LSH),e.xp6(2),e.hij(" ",n.downTemplCms.Title," "),e.xp6(2),e.hij(" (",n.downTemplCms.SearchTitle,") "),e.xp6(3),e.Oqu(n.downTemplCms.SearchDescription),e.xp6(3),e.Oqu(n.uploadVehicleCsvFileCms.Title),e.xp6(4),e.hij(" ",n.uploadVehicleCsvFileCms.LongDescription," "),e.xp6(3),e.Oqu(n.uploadVehicleCsvFileCms.SearchTitle),e.xp6(10),e.Q6J("ngModel",n.fileName)("ngModelOptions",e.DdM(17,ve)),e.xp6(2),e.Oqu(n.fileInvalidMessage),e.xp6(1),e.Q6J("ngIf",n.isFileValid),e.xp6(2),e.Q6J("disabled",s.submitted&&s.invalid)}},directives:[I.D,C._Y,C.JL,C.F,J.R,_.D,w.d,T.xw,T.yH,b.hX,C.Fj,C.JJ,C.On,h.O5,h.PC,ce.Zl,P.P,L.O],styles:["mat-divider[_ngcontent-%COMP%]{width:65px}.progress-text[_ngcontent-%COMP%]{color:#fff;display:inline-block;font-size:16px;padding:15px 0}.r-brackets[_ngcontent-%COMP%]{white-space:nowrap;padding-left:1.3em}.upload-btn[_ngcontent-%COMP%]{height:48px!important;border-bottom-right-radius:0!important;border-top-right-radius:0!important;width:100%}.upload-element[_ngcontent-%COMP%]{border:1px solid #c4c4c4;border-radius:0 10px 10px 0/0px 10px 10px 0px;height:48px;width:100%}button[_ngcontent-%COMP%]:not(.mat-icon-button){padding-left:2.25rem;padding-right:2.25rem}.progress[_ngcontent-%COMP%]{overflow:hidden;height:20px;background-color:#f5f5f5;box-shadow:inset 0 1px 2px #0000001a}.progress-bar[_ngcontent-%COMP%]{float:left;width:0%;height:100%;font-size:12px;color:#fff;text-align:center;background-color:#428bca;box-shadow:inset 0 -1px #00000026;transition:width .6s ease}.progress-bar-success[_ngcontent-%COMP%]{background-color:#5cb85c}.progress-striped[_ngcontent-%COMP%]   .progress-bar-success[_ngcontent-%COMP%]{background-image:linear-gradient(45deg,rgba(255,255,255,.15) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.15) 50%,rgba(255,255,255,.15) 75%,transparent 75%,transparent)}.progress-bar-custom-corners[_ngcontent-%COMP%]{border-bottom-left-radius:0;border-top-left-radius:0;height:48px}@media only screen and (max-width: 600px){button[_ngcontent-%COMP%]:not(.mat-icon-button){padding-left:1.25rem}}"]}),i})();var O=a(79150),me=a(91402),he=a(49016);function fe(i,l){if(1&i&&e._UZ(0,"review-order",7),2&i){const t=e.oxw();e.Q6J("data",t.reviewData)("ezTagMailingAddress",t.mailingInfo)("isAddEzTag",!0)}}let Me=(()=>{class i extends me.W{constructor(t,n,s,r,o,d,m,x,y,R,Ge){super(d),this.parent=t,this.state=n,this.vehiclesManagerService=s,this.cmsReplacementService=r,this.dialogService=o,this.toasterService=d,this.webStorage=m,this.vehicleService=x,this.checkoutWebApiService=y,this.mailingService=R,this.currentUser=Ge,this.deliveryMethod={},this.paymentDueInfo={}}ngOnInit(){var t=this;return(0,u.Z)(function*(){var n,s,r,o;t.mvuDetails=t.webStorage.getValue("MVU_DETAILS"),t.parent.showStepper=!0,t.paymentDueInfo=yield t.vehiclesManagerService.getPaymentInfo(),t.cartTags=null===(s=null===(n=t.mvuDetails)||void 0===n?void 0:n.vehicleList)||void 0===s?void 0:s.filter(x=>"ADD"===x.action.toUpperCase()),t.inactiveTags=null===(o=null===(r=t.mvuDetails)||void 0===r?void 0:r.vehicleList)||void 0===o?void 0:o.filter(x=>"INACTIVATE"===x.action.toUpperCase());const d=yield t.vehicleService.getVehicleInformation();t.vehicleClassDescList=null==d?void 0:d.classes,t.setClassDesc(),t.deliveryMethod=t.vehiclesManagerService.getDeliveryMethod(),t.currentBalance=t.vehiclesManagerService.getCurrentBalance(),t.mailingInfo=yield t.mailingService.getMailingAddress(),t.pageCms.RebillToolTip=t.cmsReplacementService.transformTemplate(t.pageCms.RebillToolTip,{currentBalAmt:t.currentBalance,minReqAmt:t.paymentDueInfo.depositAmt,totalAmt:t.paymentDueInfo.totalAmt}),t.setupReviewOrderData()})()}setupReviewOrderData(){const t=this.mapOrderSummary(),n=this.mapDeliveryMethod(),s=this.mapPaymentSummary();this.reviewData={orderSummary:t,deliveryMethod:n,paymentSummary:s}}mapOrderSummary(){return{display:!0,summary:{title:this.pageCms.Title,description:this.pageCms.LongDescription},details:[{title:this.pageCms.ezTagSubtitle,tags:this.cartTags,isPlate:!1},{title:this.pageCms.InactivationSubtitle,tags:this.inactiveTags,isPlate:!1}],operations:{isEditable:!1,isRemoveable:!1,removeAllOrders:!1},stateList:this.stateList}}mapDeliveryMethod(){return{display:!0,header:this.pageCms.DeliveryMethodTitle,context:this.pageCms.deliveryMethodDesc,type:this.deliveryMethod.deliveryMethod,operations:[{label:"Edit",display:!1}]}}mapPaymentSummary(){return{header:this.pageCms.PaymentSummaryTitle,paymentContext:this.pageCms.PaymentContext,replenishmentAmt:{link:{linkDesc:"Learn more about Replenishment amounts",onClickContent:this.replenishmentAmtModalCms},isOptIn:this.currentUser.getCurrentUser().rebillOptIn},tagInfo:{display:!0,contextDesc:this.pageCms.TagInfo,link:{linkDesc:this.pageCms.TagInfoModalLink,onClickContent:this.tagInfoModalCms}},paymentDueInfo:{tagSalesAmt:this.paymentDueInfo.tagSalesAmt,totalAmt:this.paymentDueInfo.totalAmt,rebillTooltip:this.pageCms.RebillToolTip}}}setClassDesc(){var t=this;return(0,u.Z)(function*(){t.cartTags.forEach(n=>{n.vehicleClassDesc=t.getVehicleClassDesc(n.vehicleClassCode)}),t.inactiveTags.forEach(n=>{n.vehicleClassDesc=t.getVehicleClassDesc(n.vehicleClassCode)})})()}getVehicleClassDesc(t){var n;const s=null===(n=this.vehicleClassDescList)||void 0===n?void 0:n.filter(r=>{var o;return(null===(o=r.value)||void 0===o?void 0:o.toString())===(null==t?void 0:t.toString())});return s.length>0?s[0].label:null}submit(t){var n=this;return(0,u.Z)(function*(){var s,r,o,d;(yield n.mailingService.setMailingAddressOnAcctLevel())&&(yield n.checkoutWebApiService.mvuCheckout({vehicleList:null===(s=n.mvuDetails)||void 0===s?void 0:s.vehicleList,vehicleAddList:null===(o=null===(r=n.mvuDetails)||void 0===r?void 0:r.vehicleList)||void 0===o?void 0:o.filter(y=>"ADD"===y.action.toUpperCase()),fileName:null===(d=n.mvuDetails)||void 0===d?void 0:d.fileName}))&&(yield n.state.go(t))})()}cancel(t){var n=this;return(0,u.Z)(function*(){const s={cmsContent:{Title:n.cancellationModal.Title,PrimaryContent:n.cancellationModal.LongDescription,AcceptBtn:"No",CancelBtn:"Yes"}};(yield n.dialogService.openGenericModal(O.E5,s))||(n.vehiclesManagerService.clearData(),n.vehicleService.destroyMvuDetails(),yield n.state.go(t))})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(S),e.Y36(Z.StateService),e.Y36(v.Tg),e.Y36(Y._n),e.Y36(M.xA),e.Y36(M.MJ),e.Y36(M.VW),e.Y36(M.fi),e.Y36(v.fy),e.Y36(v.H3),e.Y36(M.SF))},i.\u0275cmp=e.Xpm({type:i,selectors:[["vehicles-mvu-review"]],inputs:{pageCms:"pageCms",replenishmentAmtModalCms:"replenishmentAmtModalCms",tagInfoModalCms:"tagInfoModalCms",cancellationModal:"cancellationModal",stateList:"stateList"},features:[e.qOj],decls:10,vars:1,consts:[[1,"refresh-2020"],[3,"data","ezTagMailingAddress","isAddEzTag",4,"ngIf"],[3,"next","cancel"],["wizard-next",""],["wizard-previous","","fxLayout","row","fxLayoutAlign","start center"],["svgIcon","previous-arrow"],["wizard-cancel",""],[3,"data","ezTagMailingAddress","isAddEzTag"]],template:function(t,n){1&t&&(e.TgZ(0,"page-centered-container",0),e.YNc(1,fe,1,3,"review-order",1),e.TgZ(2,"wizard-ui",2),e.NdJ("next",function(r){return n.submit(r)})("cancel",function(r){return n.cancel(r)}),e.TgZ(3,"span",3),e._uU(4,"PLACE ORDER"),e.qZA(),e.TgZ(5,"span",4),e._UZ(6,"mat-icon",5),e._uU(7," Previous "),e.qZA(),e.TgZ(8,"span",6),e._uU(9,"Cancel"),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.reviewData))},directives:[I.D,h.O5,he.C,P.P,L.O,T.xw,T.Wh,F.Hw],styles:["tool-tip[_ngcontent-%COMP%]   [tool-tip-message][_ngcontent-%COMP%]{width:277px;padding:16px;font-family:Montserrat;font-size:12px;line-height:15px;font-weight:600}@media screen and (max-width: 959.98px){tool-tip[_ngcontent-%COMP%]   [tool-tip-message][_ngcontent-%COMP%]{left:calc(50vw - 138.5px);top:-92px}}card-container[_ngcontent-%COMP%]{display:block;margin-top:32px}wizard-ui[_ngcontent-%COMP%]{display:block;margin-top:32px}wizard-ui[_ngcontent-%COMP%]   [wizard-next][_ngcontent-%COMP%]{text-transform:uppercase}wizard-ui[_ngcontent-%COMP%]   [wizard-cancel][_ngcontent-%COMP%], wizard-ui[_ngcontent-%COMP%]   [wizard-previous][_ngcontent-%COMP%]{text-transform:capitalize}mat-divider[_ngcontent-%COMP%]{width:65px}"]}),i})();var Ce=a(44367),xe=a(38898),ye=a(32761),Te=a(23204),Ae=a(38321),Ze=a(47553),we=a(70580),De=a(65380),Se=a(29719);function Ie(i,l){if(1&i&&(e.ynx(0),e.TgZ(1,"span",15),e._uU(2,"Ship EZ TAG(s) to:"),e.qZA(),e._UZ(3,"address-display",16),e.BQk()),2&i){const t=e.oxw().ngIf;e.xp6(3),e.Q6J("address",t)("international",t.international)("showLabels",!1)("showEdit",!1)}}function Oe(i,l){if(1&i&&(e.TgZ(0,"section",5)(1,"span"),e._uU(2),e.qZA(),e.YNc(3,Ie,4,4,"ng-container",8),e.qZA()),2&i){const t=e.oxw();e.xp6(2),e.Oqu(t.deliveryMethod),e.xp6(1),e.Q6J("ngIf",t.isByMail)}}function be(i,l){if(1&i&&e._UZ(0,"address-display",16),2&i){const t=e.oxw(2);e.Q6J("address",t.billingInfo.billingType===t.BillingType.Credit?t.billingInfo.credit:t.billingInfo.eft)("international",t.billingInfo.billingType===t.BillingType.Credit?t.billingInfo.credit.international:t.billingInfo.eft.international)("showLabels",!1)("showEdit",!1)}}function Fe(i,l){if(1&i&&(e.TgZ(0,"section"),e._UZ(1,"payment-display",17),e.TgZ(2,"article",18),e.YNc(3,be,1,4,"address-display",19),e.qZA()()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("billingType",t.billingInfo.billingType)("bankDetails",t.billingInfo.eft)("creditCard",t.billingInfo.credit)("hideTitle",!0)("showAccountNumber",!0)("showNameOnCard",!0)("showLabels",!1),e.xp6(2),e.Q6J("ngIf",t.billingInfo&&t.billingInfo.billingType)}}function Ue(i,l){if(1&i&&(e.TgZ(0,"div",25),e._UZ(1,"vehicle-cart-row-component",26),e.qZA()),2&i){const t=l.$implicit;e.xp6(1),e.Q6J("canRemove",!1)("canEdit",!1)("ezTag",t)}}function _e(i,l){if(1&i&&(e.TgZ(0,"div",20)(1,"div")(2,"fx-row",21)(3,"div",22)(4,"mat-label",23),e._uU(5),e.qZA()()()()(),e.YNc(6,Ue,2,3,"div",24)),2&i){const t=e.oxw();e.xp6(2),e.Q6J("isLabel",!0)("backgroundColorClass","transparent-background"),e.xp6(3),e.hij(" ",t.pageCms.tagsRequested," "),e.xp6(1),e.Q6J("ngForOf",t.tags)}}function Pe(i,l){if(1&i&&(e.TgZ(0,"div",25),e._UZ(1,"vehicle-cart-row-component",26),e.qZA()),2&i){const t=l.$implicit;e.xp6(1),e.Q6J("canRemove",!1)("canEdit",!1)("ezTag",t)}}function Le(i,l){if(1&i&&(e.TgZ(0,"div",20)(1,"div")(2,"fx-row",21)(3,"div",22)(4,"mat-label",23),e._uU(5),e.qZA()()()()(),e.YNc(6,Pe,2,3,"div",24)),2&i){const t=e.oxw();e.xp6(2),e.Q6J("isLabel",!0)("backgroundColorClass","transparent-background"),e.xp6(3),e.hij(" ",t.pageCms.InactivationSubtitle," "),e.xp6(1),e.Q6J("ngForOf",t.inactiveTags)}}let Re=(()=>{class i{constructor(t,n,s,r,o,d){this.frame=t,this.state=n,this.vehiclesManagerService=s,this.accountService=r,this.webStorage=o,this.vehicleService=d,this.billingInfo={credit:{},eft:{}},this.tags=[],this.BillingType=Ce.ck}ngOnInit(){var t=this;return(0,u.Z)(function*(){var n,s,r,o;t.mvuDetails=t.webStorage.getValue("MVU_DETAILS"),t.frame.showStepper=!0,t.paymentDate=new Date,t.paymentAmount=(yield t.vehiclesManagerService.getPaymentInfo()).totalAmt,t.getActInfo(),t.mailingAddress$=t.accountService.getMailingInfo(),t.setDeliveryMethod(),t.billingInfo=yield t.vehiclesManagerService.getBillingInfo(),t.tags=null===(s=null===(n=t.mvuDetails)||void 0===n?void 0:n.vehicleList)||void 0===s?void 0:s.filter(m=>"ADD"===m.action.toUpperCase()),t.inactiveTags=null===(o=null===(r=t.mvuDetails)||void 0===r?void 0:r.vehicleList)||void 0===o?void 0:o.filter(m=>"INACTIVATE"===m.action.toUpperCase());const d=yield t.vehicleService.getVehicleInformation();t.vehicleClassDescList=null==d?void 0:d.classes,t.setClassDesc()})()}setClassDesc(){var t=this;return(0,u.Z)(function*(){t.tags.forEach(n=>{n.vehicleClassDesc=t.getVehicleClassDesc(n.vehicleClassCode)}),t.inactiveTags.forEach(n=>{n.vehicleClassDesc=t.getVehicleClassDesc(n.vehicleClassCode)})})()}getVehicleClassDesc(t){var n;const s=null===(n=this.vehicleClassDescList)||void 0===n?void 0:n.filter(r=>{var o;return(null===(o=r.value)||void 0===o?void 0:o.toString())===(null==t?void 0:t.toString())});return s.length>0?s[0].label:null}setDeliveryMethod(){const t=this.vehiclesManagerService.getDeliveryMethod();this.isByMail=t.deliveryMethod===O.l.Mail,this.deliveryMethod="Delivery Method:"+(this.isByMail?"By Mail":"EZ TAG Store Pickup")}getActInfo(){const t=this.vehiclesManagerService.getCurrentUser();this.actNumber=t.acctId,this.actName=t.firstName+" "+t.lastName}viewVehiclesClick(){var t=this;return(0,u.Z)(function*(){t.vehiclesManagerService.clearData(),t.vehicleService.destroyMvuDetails(),yield t.state.go(v.GC.Root)})()}goToAccountOverview(){var t=this;return(0,u.Z)(function*(){t.vehiclesManagerService.clearData(),t.vehicleService.destroyMvuDetails(),yield t.state.go(V.Dn.Frame)})()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(S),e.Y36(Z.StateService),e.Y36(v.Tg),e.Y36(M.BR),e.Y36(xe.V),e.Y36(M.fi))},i.\u0275cmp=e.Xpm({type:i,selectors:[["vehicles-mvu-receipt"]],inputs:{pageCms:"pageCms"},decls:49,vars:26,consts:[["fxLayout","row","fxLayoutAlign","space-between end",1,"title"],["fxLayout","row","fxLayoutAlign","space-between end",1,"summary","paymentAmount"],[3,"value"],[1,"summary"],["fxLayout","row","fxLayoutAlign","space-between end"],["fxLayout","column"],["translation-skip",""],["fxLayout","column",4,"ngIf"],[4,"ngIf"],[1,"u-spacing--widthFill"],[3,"ngIf"],["fxLayout","row","fxLayout.lt-md","column"],["reverseOrder","true",3,"main"],["action-main",""],[3,"click"],[1,"itemFont"],[3,"address","international","showLabels","showEdit"],[3,"billingType","bankDetails","creditCard","hideTitle","showAccountNumber","showNameOnCard","showLabels"],[1,"u-spacing__addressToPaymentDisplay--marginTop"],[3,"address","international","showLabels","showEdit",4,"ngIf"],["fxLayout","row","fxLayoutAlign","start start"],[3,"isLabel","backgroundColorClass"],["col-start","",1,"fx-flex-auto","fx-layout-row","fx-layout-align-start-center"],[1,"fx-flex-auto-shrink-more","limited-flex"],["fxLayout","row","fxLayoutAlign","start start","class","u-spacing--widthFill",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start start",1,"u-spacing--widthFill"],[3,"canRemove","canEdit","ezTag"]],template:function(t,n){1&t&&(e.TgZ(0,"page-centered-container")(1,"card-container")(2,"header",0)(3,"h2"),e._uU(4),e.qZA()(),e._UZ(5,"mat-divider"),e.TgZ(6,"article"),e._uU(7),e.qZA(),e.TgZ(8,"p"),e._uU(9),e.qZA(),e.TgZ(10,"section")(11,"div",1)(12,"span"),e._uU(13),e.qZA(),e._UZ(14,"currency",2),e.qZA(),e.TgZ(15,"div",3),e._uU(16),e.ALo(17,"dateWithTimeZone"),e.qZA()(),e.TgZ(18,"p"),e._uU(19),e.qZA(),e.TgZ(20,"header",4)(21,"h3"),e._uU(22),e.qZA()(),e._UZ(23,"mat-divider"),e.TgZ(24,"section",5)(25,"span",6),e._uU(26),e.qZA(),e.TgZ(27,"span",6),e._uU(28),e.qZA()(),e.YNc(29,Oe,4,2,"section",7),e.ALo(30,"async"),e.TgZ(31,"header",4)(32,"h3"),e._uU(33),e.qZA()(),e._UZ(34,"mat-divider"),e.YNc(35,Fe,4,8,"section",8),e.TgZ(36,"header",4)(37,"h3"),e._uU(38),e.qZA()(),e._UZ(39,"mat-divider"),e.TgZ(40,"section",9),e.YNc(41,_e,7,4,"ng-template",10),e.YNc(42,Le,7,4,"ng-template",10),e.qZA(),e.TgZ(43,"section",11)(44,"action-buttons",12),e.NdJ("main",function(){return n.goToAccountOverview()}),e.TgZ(45,"span",13),e._uU(46),e.qZA()(),e.TgZ(47,"a",14),e.NdJ("click",function(){return n.viewVehiclesClick()}),e._uU(48),e.qZA()()()()),2&t&&(e.xp6(4),e.hij(" ",n.pageCms.Title," "),e.xp6(3),e.Oqu(n.pageCms.LongDescription),e.xp6(2),e.Oqu(n.pageCms.ShortDescription),e.xp6(4),e.hij("",n.pageCms.paymentAmount,":"),e.xp6(1),e.Q6J("value",n.paymentAmount),e.xp6(2),e.AsE(" ",n.pageCms.paymentReceivedOn," ",e.xi3(17,21,n.paymentDate,"dateTime4")," "),e.xp6(3),e.hij(" ",n.pageCms.replenishAmt,""),e.xp6(3),e.hij(" ",n.pageCms.accountInfo," "),e.xp6(4),e.AsE(" ",n.pageCms.accountName,": ",n.actName,""),e.xp6(2),e.AsE("",n.pageCms.accountNumber,": ",n.actNumber,""),e.xp6(1),e.Q6J("ngIf",e.lcZ(30,24,n.mailingAddress$)),e.xp6(4),e.hij(" ",n.pageCms.billingInfo," "),e.xp6(2),e.Q6J("ngIf",n.billingInfo),e.xp6(3),e.hij(" ",n.pageCms.tagsOrdered," "),e.xp6(3),e.Q6J("ngIf",(null==n.tags?null:n.tags.length)>0),e.xp6(1),e.Q6J("ngIf",(null==n.inactiveTags?null:n.inactiveTags.length)>0),e.xp6(4),e.Oqu(n.pageCms.accountDashboard),e.xp6(2),e.Oqu(n.pageCms.manageMyVehicles))},directives:[I.D,_.D,T.xw,T.Wh,w.d,ye.Q,h.O5,Te.G,Ae.K,Ze.b,b.hX,h.sg,we.L,De.O],pipes:[Se.J,h.Ov],styles:["[_nghost-%COMP%]{width:100%}[_nghost-%COMP%]   .hidden[_ngcontent-%COMP%]{display:none;visibility:hidden}[_nghost-%COMP%]   .fx-flex-auto[_ngcontent-%COMP%]{flex:1 1 auto;box-sizing:border-box}[_nghost-%COMP%]   .fx-flex-none[_ngcontent-%COMP%]{flex:0 0 auto;box-sizing:border-box}[_nghost-%COMP%]   .fx-flex-auto-shrink-more[_ngcontent-%COMP%]{flex:1 2 auto;box-sizing:border-box}[_nghost-%COMP%]   .fx-flex-auto-grow-more[_ngcontent-%COMP%]{flex:2 1 auto;box-sizing:border-box}[_nghost-%COMP%]   .fx-layout-row[_ngcontent-%COMP%]{flex-direction:row;box-sizing:border-box;display:flex}[_nghost-%COMP%]   .fx-layout-column[_ngcontent-%COMP%]{flex-direction:column;box-sizing:border-box;display:flex}[_nghost-%COMP%]   .fx-layout-align-start-center[_ngcontent-%COMP%]{align-content:center;justify-content:flex-start;align-items:center}[_nghost-%COMP%]   .fx-layout-align-end-center[_ngcontent-%COMP%]{align-content:center;justify-content:flex-end;align-items:center}[_nghost-%COMP%]   .limited-flex[_ngcontent-%COMP%]{min-width:170px;max-width:530px;width:100%}[_nghost-%COMP%]   .unlimited-flex[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .limited-flex-end[_ngcontent-%COMP%]{min-width:70px;max-width:80px;width:100%;text-align:end}[_nghost-%COMP%]   .larger-limited-flex-end[_ngcontent-%COMP%]{min-width:143px;max-width:145px;width:100%;text-align:end}[_nghost-%COMP%]   .table-space[_ngcontent-%COMP%]{margin-top:8px}[_nghost-%COMP%]   .table-space.lt-md[_ngcontent-%COMP%]{margin-top:2px}@media screen and (max-width: 959.98px){h2[_ngcontent-%COMP%]{margin-top:16px}}action-buttons[_ngcontent-%COMP%] + a[_ngcontent-%COMP%]{padding:10px 20px}@media screen and (max-width: 959.98px){action-buttons[_ngcontent-%COMP%] + a[_ngcontent-%COMP%]{width:100%;text-align:center}}p[_ngcontent-%COMP%], section[_ngcontent-%COMP%]{margin-bottom:32px}mat-divider[_ngcontent-%COMP%]{width:64px;margin-top:16px;margin-bottom:20px}.title[_ngcontent-%COMP%]{padding-top:21px}.summary[_ngcontent-%COMP%]{height:50px;padding:16px 16px 11px;font-size:16px;line-height:26px;margin:0 -16px}.paymentAmount[_ngcontent-%COMP%]{border-radius:10px;background-color:#e0e0ef;font-weight:700}"]}),i})();var Ee=a(5472);function ze(i,l){if(1&i&&(e.ynx(0),e.TgZ(1,"div",17)(2,"div",7),e._UZ(3,"div",18),e.qZA()(),e.BQk()),2&i){const t=e.oxw();e.xp6(3),e.Q6J("innerHtml",t.cmsMvuDeliveryMethod.PickUpOption,e.oJD)}}let Ve=(()=>{class i{constructor(t,n,s,r,o,d){this.parent=t,this.stateService=n,this.vehiclesManagerService=s,this.dialogService=r,this.mailingService=o,this.environmentConfig=d,this.selectedDeliveryMethod=""}ngOnInit(){var t=this;return(0,u.Z)(function*(){t.deliveryMethod=t.vehiclesManagerService.getDeliveryMethod(),t.mailingInfo=yield t.mailingService.getMailingAddress(),t.allowPickup=t.environmentConfig.tagDeliveryConfig.MvuAllowPickup})()}cancel(t){var n=this;return(0,u.Z)(function*(){const s={cmsContent:{Title:n.cancellationModal.Title,PrimaryContent:n.cancellationModal.LongDescription,AcceptBtn:"No",CancelBtn:"Yes"}};(yield n.dialogService.openGenericModal(O.E5,s))||(n.vehiclesManagerService.clearData(),yield n.stateService.go(t))})()}nextStep(t){var n=this;return(0,u.Z)(function*(){n.deliveryMethod.deliveryMethod=n.selectedDeliveryMethod,n.vehiclesManagerService.setDeliveryMethod(n.deliveryMethod),yield n.stateService.go(t)})()}onMailingAddressEdit(t){var n=this;return(0,u.Z)(function*(){n.mailingService.onMailingAddressEdit(t,n.parent.stateList,n.parent.countryList,O.zy)})()}disable(){var t;return"mail"===this.selectedDeliveryMethod&&null===(null===(t=this.mailingInfo)||void 0===t?void 0:t.address1)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(S),e.Y36(Z.StateService),e.Y36(v.Tg),e.Y36(M.xA),e.Y36(v.H3),e.Y36(B.U4))},i.\u0275cmp=e.Xpm({type:i,selectors:[["vehicles-mvu-delivery"]],inputs:{cmsMvuDeliveryMethod:"cmsMvuDeliveryMethod",cancellationModal:"cancellationModal"},decls:30,vars:8,consts:[[1,"refresh-2020"],["validation-focus","","novalidate",""],["Form","ngForm"],[1,"u-spacing__fieldToSection--marginTop"],[1,"u-spacing__divider--marginTopBottom"],["fxLayout","column","fxLayoutAlign","start start",1,"u-spacing--widthFill"],["fxLayout","row","fxLayoutAlign","start start"],["fxLayout","column","fxLayoutAlign","start start",1,"descriptions"],[4,"ngIf"],[3,"isMvu","mailingInfo","deliveryMethod","isAddEzTag","deliveryMethodChange","onEdit"],[1,"u-spacing__buttonToField--marginTop"],[3,"disabled","next","cancel"],["Wizard",""],["wizard-next",""],["wizard-previous","","fxLayout","row","fxLayoutAlign","start center"],["svgIcon","previous-arrow"],["wizard-cancel",""],["fxLayout","row","fxLayoutAlign","start start",1,"u-spacing__fieldToSection--marginTop"],[3,"innerHtml"]],template:function(t,n){if(1&t&&(e.TgZ(0,"page-centered-container",0)(1,"form",1,2)(3,"div",3)(4,"card-container")(5,"header")(6,"h2"),e._uU(7),e.qZA(),e._UZ(8,"mat-divider",4),e.qZA(),e.TgZ(9,"section",5)(10,"div",6)(11,"div",7)(12,"div")(13,"b"),e._uU(14,"Note: "),e.qZA(),e._uU(15),e.qZA()()(),e.YNc(16,ze,4,1,"ng-container",8),e.qZA(),e.ynx(17),e.TgZ(18,"choose-delivery-method",9),e.NdJ("deliveryMethodChange",function(r){return n.selectedDeliveryMethod=r})("onEdit",function(r){return n.onMailingAddressEdit(r)}),e._uU(19,"> "),e.qZA(),e.BQk(),e.qZA(),e.TgZ(20,"section",10)(21,"wizard-ui",11,12),e.NdJ("next",function(r){return n.nextStep(r)})("cancel",function(r){return n.cancel(r)}),e.TgZ(23,"span",13),e._uU(24,"CONTINUE"),e.qZA(),e.TgZ(25,"span",14),e._UZ(26,"mat-icon",15),e._uU(27," Previous "),e.qZA(),e.TgZ(28,"span",16),e._uU(29,"Cancel"),e.qZA()()()()()()),2&t){const s=e.MAs(2);e.xp6(7),e.Oqu(n.cmsMvuDeliveryMethod.Title),e.xp6(8),e.Oqu(n.cmsMvuDeliveryMethod.Note),e.xp6(1),e.Q6J("ngIf",!n.allowPickup),e.xp6(2),e.Q6J("isMvu",!0)("mailingInfo",n.mailingInfo)("deliveryMethod",n.selectedDeliveryMethod)("isAddEzTag",!0),e.xp6(3),e.Q6J("disabled",s.submitted&&s.invalid||n.disable())}},directives:[I.D,C._Y,C.JL,C.F,J.R,_.D,w.d,T.xw,T.Wh,h.O5,Ee.z,P.P,L.O,F.Hw],styles:["mat-divider[_ngcontent-%COMP%]{width:65px}"]}),i})();var Ne=a(96471),Be=a(8769);const Ye={[p.G.Mvu]:S,[p.G.MvuUpload]:ge,[p.G.MvuDeliveryMethod]:Ve,[p.G.MvuReviewOrder]:Me,[p.G.MvuReceipt]:Re},Je=W.map(i=>({...i,component:Ye[i.name]}));let Qe=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[v.fy,Be.n,v.Tg,h.uU,h.rS,Ne.e,v.l3],imports:[[(0,$.n4)([z.U4],l=>l.useNewMvu?Je:[]),z.ez,h.ez,C.u5,G.LD,b.lN,F.Ps,w.t,j.D,Q.o9,K.n,q.lg,H.U]]}),i})()}}]);